<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>svg管道流动</title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		.pipe-svg-box {
			position: relative;
		}
		svg {
			position: absolute;
		}
	</style>
</head>
<body>
<div class="pipe-svg-box" id="pipSvgBox">
	<svg id="pipeSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="827" height="500" viewBox="0 0 827 500">
	  <defs>
	    <style>
	      .cls-1, .cls-10, .cls-11, .cls-12, .cls-13, .cls-14, .cls-15, .cls-16, .cls-17, .cls-2, .cls-3, .cls-4, .cls-5, .cls-6, .cls-7, .cls-8, .cls-9 {
	        fill: none;
	        stroke-width: 4.4px;
	        fill-rule: evenodd;
	      }

	      .cls-1 {
	        stroke: #8fc549;
	        filter: url(#filter);
	      }

	      .cls-2 {
	        stroke: #ba82f3;
	        filter: url(#filter-2);
	      }

	      .cls-10, .cls-11, .cls-12, .cls-3, .cls-7, .cls-9 {
	        stroke: #f1ad09;
	      }

	      .cls-3 {
	        filter: url(#filter-3);
	      }

	      .cls-4 {
	        stroke: #41bdeb;
	        filter: url(#filter-4);
	      }

	      .cls-5 {
	        stroke: #329694;
	        filter: url(#filter-5);
	      }

	      .cls-6 {
	        stroke: #548bf2;
	        filter: url(#filter-6);
	      }

	      .cls-7 {
	        filter: url(#filter-7);
	      }

	      .cls-8 {
	        stroke: #e96da0;
	        filter: url(#filter-8);
	      }

	      .cls-9 {
	        filter: url(#filter-9);
	      }

	      .cls-10 {
	        filter: url(#filter-10);
	      }

	      .cls-11 {
	        filter: url(#filter-11);
	      }

	      .cls-12 {
	        filter: url(#filter-12);
	      }

	      .cls-13 {
	        stroke: #5dd4a4;
	        filter: url(#filter-13);
	      }

	      .cls-14 {
	        stroke: #7f9a0a;
	        filter: url(#filter-14);
	      }

	      .cls-15 {
	        stroke: #e47215;
	        filter: url(#filter-15);
	      }

	      .cls-16 {
	        stroke: #2ab300;
	        filter: url(#filter-16);
	      }

	      .cls-17 {
	        stroke: #e85252;
	        filter: url(#filter-17);
	      }
	    </style>
	    <filter id="filter" x="449" y="191" width="46" height="55" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-2" x="311" y="198" width="149" height="51" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-3" x="152" y="97" width="94" height="43" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-4" x="285" y="407" width="294" height="112.656" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-5" x="515" y="302" width="245" height="51" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-6" x="458" y="213" width="71" height="207" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-7" x="635" y="300.281" width="124" height="185.719" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-8" x="443" y="290.531" width="128" height="69.469" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-9" x="30" y="54" width="658" height="318" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-10" x="452" y="207.625" width="280" height="237.375" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-11" x="453" y="202" width="306" height="111.406" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-12" x="544" y="411" width="205" height="90" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-13" x="540" y="157" width="108" height="63" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-14" x="683" y="116" width="48" height="52" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-15" x="640" y="150.562" width="47" height="21.438" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-16" x="723" y="6" width="33" height="123" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	    <filter id="filter-17" x="721" y="116.812" width="12" height="57.188" filterUnits="userSpaceOnUse">
	      <feOffset result="offset" dy="8" in="SourceAlpha"/>
	      <feGaussianBlur result="blur" stdDeviation="1.732"/>
	      <feFlood result="flood" flood-opacity="0.2"/>
	      <feComposite result="composite" operator="in" in2="blur"/>
	      <feBlend result="blend" in="SourceGraphic"/>
	    </filter>
	  </defs>

		<path class="cls-1" time="3200" d="M452.5,237s-10.361-41.591,38.5-44"/>
		<path class="cls-2" time="2820" d="M314,201s96.874,1.692,142.5,35.5"/>
		<path class="cls-3" time="3000" d="M154,124s53.388-1.688,86-27"/>
		<path class="cls-4" time="2650" d="M287,506s79.387-80.613,110-77,54.641,17.785,89-11,55.75,14.211,90,33"/>
		<path class="cls-5" time="2700" d="M522,308s14.776,37.695,63,28,65.656,8.276,91-12,80-22,80-22"/>
		 <path class="cls-6" time="2700" d="M463,213s48.367,29.02,56,54-13.238,49.119-1,82,8.887,46.74,0,60"/>
		<path class="cls-7" time="2700" d="M756,304s-65.027,40.93-72.5,55.5-8.769,20.524-8.5,39.5c0.189,13.3-32.777,44.127-33,76"/>
		<path class="cls-8" time="2700" d="M463,299s-37.518,36.607,14,43l49,2s35.97,4.589,37-22c1.167-30.106-34-27-34-27l-56,2"/>
		<path class="cls-9" time="2550" d="M33,56s134.418,0.938,173,28,67.805,5.352,115,44,154.4,82.316,184,117c33.112,38.8,56.925,12.2,68,8,11.178-4.238,37.313-8.758,43,31,5.254,36.735,34.441,15.6,60,64l9,12"/>
		<path class="cls-10" time="2640" d="M725,434c-16.79-23.824-45-30-45-30-29.366-6.681-51.361-19.285-50-52,1.349-32.423-29.484-64.573-70-74-19.754-4.6-35-32-35-32-14.715-26.728-71-34-71-34"/>
		<path class="cls-11" time="2650" d="M455,209s87.527-14.806,115,10c26.467,23.9,121.088,58.73,138.973,65.815A352.159,352.159,0,0,0,756,300"/>
		<path class="cls-12" time="2700" d="M548,479s30.818,13.8,72-1,51.824-12.035,62-15c9.954-2.9,29.39-5.689,60-52"/>
		<path class="cls-13" time="2900" d="M542,206s13.061-24.506,37-32,42.285-5.695,63-17"/>
		<path class="cls-14" time="3300" d="M685,154s20.738-33.082,42-38"/>
		<path class="cls-15" time="3600" d="M641,158s28.658-8.859,42-2"/>
		<path class="cls-16" time="2900" d="M737,6s26.386,22.633,11,56-18.081,52.777-18,55"/>
		<path class="cls-17" time="3500" d="M730,117l-2,46"/>
	</svg>
</div>
<script>
const box = document.getElementById('pipSvgBox')
const svg = document.getElementById('pipeSvg');

liudong();

function liudong () {
	const svgFront = svg.cloneNode(true);
	svgFront.setAttribute('id', 'front');
	box.appendChild(svgFront);

	let paths = document.querySelectorAll('#front path');
	paths = Array.prototype.slice.call(paths);

	var style = '';

	paths.forEach((path,i) => {
	  path.setAttribute('id', 'path-' + i);
	  path.style.stroke = '#fff';

	  const length = path.getTotalLength();
	  const CAR_SIZE = 10;
	  let speed = 5;
	  let pathid = 'path-' + i;

	  style += `
	    #${pathid} {
		    stroke-width: 3px !important;
			stroke-dasharray: ${CAR_SIZE}, ${length/2};
			stroke-dashoffset: ${length};
			animation: dash-${i} ${speed}s linear infinite;
	    }

	    @keyframes dash-${i} {
	      from {
	        stroke-dashoffset: ${length};
	      }
	      to {
	        stroke-dashoffset: 0;
	      }
	    }`;
	    
	    replacePath(path, pathid);
	});

	const sheet = document.createElement('style');
	sheet.innerHTML = style;
	document.body.appendChild(sheet);

	// 隔一段时间重置移动点，否则会有跳动现象
	function replacePath(oldpath, id) {
		let time = parseInt(oldpath.getAttribute('time'));

		setInterval(() => {
			var oPath = document.getElementById(id);
	    	let newPath = oPath.cloneNode(true);
	    	svgFront.replaceChild(newPath, oPath);
	    }, time);
	}
}

</script>
</body>	
</html>